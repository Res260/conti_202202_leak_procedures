Getting access to a server with backups of Shadow Protect SPX (StorageCraft)
1. We go via RDP to one of the servers, in my case it is an SQL server.
2. On the desktop, we see the icon of the ShadowProtect SPX software -> click on it
3. The gui opens (if it requests credits, enter those under which you entered the rdp, or any other DA)
4. On the left, in the "Job Summary" block, we see a detailed description of the backup scheme in the "Name" field - the name of the backup of our server in the "Destination" field - the place WHERE our spx puts backups, in the form of a NAME_B. From our example, we can conclude that all backups are stored in a share with the name StorageCraft, and folders with server backups are called the name of the server itself.
5. Knowing the name of the backup server, we want to get a better idea of its structure, first of all we get the shares with the command "cmd.exe > net view \\COH-DSS3 /ALL". In response we get "Error 5: Access Denied"
6. There is no access, we are trying to knock with other accounts, DA - the answer is the same - error n 5, it would be logical to assume that in order to access the server we need either the credits of the local administrator on this very server, or the account of a special user with allocated rights
7. Suppose that if this is a dedicated user, then he has a name similar to the softina\ function: we iterate users with the occurrence of substrings (here we need to be creative): Storage, Shadow, Protect, Craft, SP, SPX, Backup, BUUser, etc. After that, we do a search on ntds.dit (hashes.txt.ntds) to find the hash, in my case the search was successful and I found the user <redacted>.local\SPAdmin (I think it's clear here that this is Shadow Protect Admin) and his hash ce31b806821bXXXXXXXXXXXXab5b3138, BUT unfortunately the search on cmd5.org didn't give a result, and I desperately need a password in cleartext. (If the hash is sufficient, then congratulations - you have achieved the result)
8. But if you still need a cleartext password or you could not find a suitable user, we will understand that if the software somehow knocks on the server, then the server knows the credits, which means they could reside on the server. We are trying to dump hashes here I will not describe in detail how to do it, but you should try hashdump (and its legitimate equivalents) and logonpasswords (and equivalents) In my case, I used a mimikatz and dumped the lsass, in which I found a cleartext password from my SPAdmin - kerberos account : * Username : SPAdmin * Domain : <redacted>Backup * Password : Backup!User (in my case, for some reason, the domain was not <redacted>.local but <redacted>Backup, although you can also knock with <redacted>.local (replace with your own value))
9. Go to the explorer, and open through it the necessary share "\\<redacted>-DSS3\StorageCraft" requests creds from me, I enter <redacted>Backup\SPAdmin and Backup!User and successfully get access
10. Also, there may be several backup servers in some grids, as an option to check this, is to click on the Backup button in the upper left corner of the gui (immediately after File) next - Destinations -> and see what ways there are to save backups



